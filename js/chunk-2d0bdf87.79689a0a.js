(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0bdf87"],{"2ded":function(e,t,o){"use strict";o.r(t);var i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ion-page"},[o("ion-header",[o("ion-toolbar",[o("ion-title",[e._v("Change Email")]),o("ion-buttons",{attrs:{slot:"start"},slot:"start"},[o("ion-button",{on:{click:e.backToProfile}},[o("ion-icon",{attrs:{src:e.i.arrowBack}})],1)],1)],1)],1),o("ion-content",{staticClass:"ion-padding"},[o("ion-grid",{attrs:{fixed:""}},[o("ion-row",[o("ion-col",{attrs:{size:"12","offset-md":"3","size-md":"6","offset-xl":"4","size-xl":"4"}},[o("form",{on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[o("ion-item",{staticClass:"ion-padding-bottom",attrs:{lines:"none"}},[o("ion-label",{attrs:{position:"stacked"}},[e._v("Current Email:")]),o("ion-text",[o("b",[e._v(e._s(e.userDetails.email))])])],1),o("ion-item",{staticClass:"input",attrs:{lines:"none"}},[o("ion-label",{attrs:{position:"stacked",for:"email"}},[e._v("New Email "),o("ion-text",{attrs:{color:"danger"}},[e._v("*")])],1),o("ion-input-vue",{attrs:{type:"email",id:"email",inputmode:"email",debounce:"300"},on:{ionBlur:e.setEmailLostFocus,ionFocus:function(t){e.email_not_focused=!1}},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),!e.$v.email.email&&e.email_not_focused?o("ion-note",{staticClass:"error ion-padding",attrs:{color:"danger"}},[e._v("Valid Email Required")]):e._e(),e.$v.email.unique||e.$v.email.$pending?e._e():o("ion-note",{staticClass:"error ion-padding",attrs:{color:"danger"}},[e._v("Email Already Taken")])],1),o("ion-item",{staticClass:"ion-padding-bottom",attrs:{lines:"none"}},[o("ion-label",{attrs:{position:"stacked"}},[e._v("Current Password:")]),o("ion-input-vue",{attrs:{type:"password",id:"userProvidedPassword"},on:{ionFocus:function(t){e.passwordCorrect=!0}},model:{value:e.userProvidedPassword,callback:function(t){e.userProvidedPassword=t},expression:"userProvidedPassword"}}),e.passwordCorrect?e._e():o("ion-note",{staticClass:"error ion-padding",attrs:{color:"danger"}},[e._v("Incorrect Password Entered")]),e.tooManyAttempts?o("ion-note",{staticClass:"error ion-padding",attrs:{color:"danger"}},[e._v("Too Many Attempts - 'Change Email' is temporarily disabled for this user - Please try again later")]):e._e()],1),o("div",{staticClass:"ion-padding"},[o("ion-button",{attrs:{type:"submit",disabled:e.$v.$invalid||e.tooManyAttempts}},[e._v("Submit")])],1)],1)])],1)],1)],1)],1)},a=[],n=(o("caad"),o("ac1f"),o("2532"),o("5319"),o("498a"),o("5530")),s=(o("96cf"),o("1da1")),r=o("b5ae"),l=o("eacc"),c=o("ff79"),d=o("2f62"),u=o("976f"),m=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];u["b"].create({message:e,position:"top",color:t?"danger":"success",duration:2e3}).then((function(e){return e.present()}))},p={name:"change-email",data:function(){return{email:"",userProvidedPassword:"",email_not_focused:!1,passwordCorrect:!0,tooManyAttempts:!1,i:c}},validations:{email:{required:r["required"],email:r["email"],unique:function(e){return Object(s["a"])(regeneratorRuntime.mark((function t(){var o,i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(0!==e.trim().length){t.next=2;break}return t.abrupt("return",!0);case 2:if(o=!0,i=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,!i.test(e)){t.next=11;break}return console.log("is a valid email, checking if unique"),t.next=8,l["a"].post(":createAuthUri?key=AIzaSyB8-xAjyYMTR0Jt1-H-ayS9FDINW4JdAhQ",{identifier:e,continueUri:window.location.href}).catch((function(e){return console.log("error:",e),!0}));case 8:a=t.sent,console.log("response:",a),o=!a.data.registered;case 11:return t.next=13,Boolean(o);case 13:return t.abrupt("return",t.sent);case 14:case"end":return t.stop()}}),t)})))()}}},computed:Object(n["a"])({},Object(d["b"])("userModule",["userDetails","userId"])),methods:{onSubmit:function(){var e=this;this.passwordCorrect=!0;var t={newEmail:this.email,userProvidedPassword:this.userProvidedPassword};console.log("new email:",t.newEmail),this.$store.dispatch("userModule/changeEmail",t).then((function(){m("Email Changed Successfully!",!1),e.userProvidedPassword=""})).catch((function(t){t.code.toUpperCase().includes("WRONG-PASSWORD")||t.code.toUpperCase().includes("INVALID_PASSWORD")?e.passwordCorrect=!1:t.code.toUpperCase().includes("TOO-MANY-REQUESTS")&&(e.tooManyAttempts=!0),m("Email not changed",!0)}))},setEmailLostFocus:function(){console.log("email lost focus"),this.$v.email.$touch(!0),this.email_not_focused=!0},backToProfile:function(){this.$router.replace({name:"profile"})}},created:function(){""===this.userDetails.email&&this.$store.dispatch("userModule/fetchUserDetails",this.userId)}},f=p,v=o("2877"),h=Object(v["a"])(f,i,a,!1,null,null,null);t["default"]=h.exports}}]);
//# sourceMappingURL=chunk-2d0bdf87.79689a0a.js.map