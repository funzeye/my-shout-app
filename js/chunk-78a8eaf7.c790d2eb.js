(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78a8eaf7"],{"7d28":function(e,t,r){},8175:function(e,t,r){"use strict";var n=r("f57b"),s=r.n(n);s.a},ad6de:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("ion-card",{staticClass:"table-card"},[r("ion-card-header",[r("ion-card-subtitle",[e._v(e._s(e.pubTable.pubFloorArea))]),r("ion-card-title",[e._v("Table # "+e._s(e.pubTable.tableNum))]),r("ion-grid",[r("ion-row",{staticClass:"ion-justify-content-start ion-padding-top"},[r("div",[0===e.pubTable.floor?r("ion-text",[e._v("Ground Floor")]):r("ion-text",[e._v("Floor #: "+e._s(e.pubTable.floor))])],1)]),r("ion-row",[r("div",[r("ion-text",[e._v("No. of Seats: "+e._s(e.pubTable.seats))])],1)])],1)],1),r("ion-card-content",[e._t("table-card-other-details"),e._t("table-card-action-button"),e._t("table-card-action-button-info")],2)],1)],1)},s=[],a={props:["i","pubTable","pubFloors"]},o=a,i=(r("8175"),r("2877")),l=Object(i["a"])(o,n,s,!1,null,null,null);t["a"]=l.exports},d5d7:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ion-page"},[r("ion-header",[r("ion-toolbar",[r("ion-title",[e._v(e._s(e.pub.pubName))]),e.pub.ownerId===e.userId?r("ion-buttons",{attrs:{slot:"end"},slot:"end"},[r("ion-button",{on:{click:e.editPub}},[r("ion-icon",{attrs:{src:e.i.settingsOutline}})],1)],1):e._e()],1)],1),r("ion-content",[e.pub.photoUrl?r("div",{staticClass:"image-container"},[r("div",{staticClass:"image",style:"background-image:url("+e.pub.photoUrl+")"})]):e._e(),r("ion-list",[r("ion-grid",{staticStyle:{"max-width":"1200px"}},[r("ion-row",e._l(e.sortedTables,(function(t){return r("ion-col",{key:t[".key"],attrs:{size:"12","size-md":"6","size-lg":"4"}},[r("table-card",{attrs:{i:e.i,pubTable:t,loggedInUserId:e.userId,pubFloors:e.pub.floors,userIsOwner:e.pub.ownerId===e.userId}})],1)})),1)],1)],1)],1)],1)},s=[],a=r("5530"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("table-card-base",{attrs:{i:e.i,pubTable:e.pubTable,pubFloors:e.pubFloors}},[r("template",{slot:"table-card-other-details"},[r("div",[e.reservation.isCancelled||!e.reservation.reservedBy||e.reservation.reservedByOwner||e.reservation.reservedBy!==e.loggedInUserId&&!e.userIsOwner?e._e():r("ion-item",{attrs:{lines:"none"}},[r("ion-label",{attrs:{position:"stacked"}},[e._v("Reserved By Patron:")]),e.reservation.patronDetails?r("ion-text",[e._v(e._s(e.reservation.patronDetails.patronName))]):e._e()],1),e.reservation.isCancelled||!e.reservation.reservedBy||e.reservation.reservedByOwner||e.reservation.reservedBy!==e.loggedInUserId&&!e.userIsOwner?e._e():r("ion-item",{attrs:{lines:"none"}},[r("ion-label",{attrs:{position:"stacked"}},[e._v("Phone Number:")]),e.reservation.patronDetails?r("ion-text",[e._v(e._s(e.reservation.patronDetails.patronPhone))]):e._e()],1),!e.reservation.isCancelled&&e.reservation.reservedBy&&e.reservation.reservedByOwner&&e.userIsOwner?r("ion-item",{attrs:{lines:"none"}},[r("ion-label",{attrs:{position:"stacked"}},[e._v("Reserved By Publican For:")]),r("ion-text",[e._v(e._s(e.reservation.patronDetails.patronName))])],1):e._e(),!e.reservation.isCancelled&&e.reservation.reservedBy&&e.reservation.reservedByOwner&&e.userIsOwner?r("ion-item",{attrs:{lines:"none"}},[r("ion-label",{attrs:{position:"stacked"}},[e._v("Phone Number:")]),r("ion-text",[e._v(e._s(e.reservation.patronDetails.patronPhone))])],1):e._e(),!e.reservation.isCancelled&&e.reservation.reservedBy?r("ion-item",{attrs:{lines:"none"}},[r("ion-label",{attrs:{position:"stacked"}},[e._v("Reserved At:")]),r("ion-text",[e._v(e._s(e._f("formatDate")(e.reservation.reservedAtDate)))])],1):e._e(),!e.reservation.isCancelled&&e.reservation.reservedBy?r("ion-item",{attrs:{lines:"none"}},[r("ion-label",{attrs:{position:"stacked"}},[e._v("Reserved Until:")]),r("ion-text",[e._v("No Limit")])],1):e._e()],1)]),!e.reservation.isCancelled&&e.reservation.reservedBy===e.loggedInUserId||!e.reservation.isCancelled&&e.userIsOwner&&e.reservation.reservedBy&&e.reservation.timeToArrivalLimit&&new Date(e.reservation.timeToArrivalLimit).getTime()<(new Date).getTime()||!e.reservation.isCancelled&&e.userIsOwner&&e.reservation.reservedBy&&!e.reservation.timeToArrivalLimit?r("template",{slot:"table-card-action-button"},[r("div",{staticClass:"ion-padding-vertical"},[r("ion-button",{attrs:{expand:"block",color:"danger",size:"default",fill:"outline"},on:{click:function(t){return t.preventDefault(),e.cancelTableReservation(t)}}},[e._v("Cancel")])],1)]):!e.reservation.isCancelled&&e.reservation.reservedBy&&e.reservation.reservedBy!==e.loggedInUserId?r("template",{slot:"table-card-action-button"},[r("div",{staticClass:"ion-padding-vertical"},[r("ion-button",{attrs:{expand:"block",size:"default",fill:"outline",color:"success",disabled:""}},[e._v("Reserved")])],1)]):r("template",{slot:"table-card-action-button"},[r("div",{staticClass:"ion-padding-vertical"},[r("ion-button",{attrs:{slot:"start",expand:"block",size:"default",fill:"outline"},on:{click:function(t){return t.preventDefault(),e.reserveTable(t)}},slot:"start"},[e._v("Reserve")])],1)]),r("template",{slot:"table-card-action-button-info"},[e.reservation.isCancelled||e.reservation.reservedBy||e.userIsOwner?e._e():r("div",{staticClass:"info-text ion-text-center ion-text-sm-start"},[e._v(" Clicking 'Reserve' will reserve this table and cancel any other active reservations you currently have ")]),e.reservation.isCancelled||e.reservation.reservedBy||!e.userIsOwner?e._e():r("div",{staticClass:"info-text ion-text-center ion-text-sm-start"},[e._v(" Clicking 'Reserve' will reserve this table on behalf of your customer ")]),e.reservation.isCancelled||e.reservation.reservedBy!==e.loggedInUserId?e._e():r("div",{staticClass:"info-text ion-text-center ion-text-sm-start"},[e._v(" Clicking 'Cancel' will cancel this reservation and allow it to be reserved by others ")]),e.reservation.isCancelled||!e.reservation.reservedBy||e.reservation.reservedBy===e.loggedInUserId||e.userIsOwner?e._e():r("div",{staticClass:"info-text ion-text-center ion-text-sm-start"},[e._v(" Table currently unavailable. ")]),!e.reservation.isCancelled&&e.reservation.reservedBy&&e.reservation.reservedBy!==e.loggedInUserId&&e.userIsOwner?r("div",{staticClass:"info-text ion-text-center ion-text-sm-start"},[e._v(" Table currently unavailable. If 'time to arrival' limit has passed you can 'Cancel' this booking to free up the table for others. Otherwise you must wait. ")]):e._e()])],2)},i=[],l=(r("4de4"),r("ad6de")),d=r("2f62"),u={props:["i","pubTable","pubFloors","loggedInUserId","userIsOwner"],data:function(){return{reservedButUnlocked:function(){return!(!this.userIsOwner||null===this.reservation.reservedBy||""===this.reservation.reservedBy)&&this.reservation.timeToArrivalLimit>new Date}}},components:{TableCardBase:l["a"]},computed:Object(a["a"])(Object(a["a"])({},Object(d["b"])("reservationModule",["allTodaysReservationsForPub"])),{},{reservation:function(){var e=this;console.log("checking if reservation exists for current table #",this.pubTable.tableNum);var t=this.allTodaysReservationsForPub;if(t&&t.length>0){var r=t.filter((function(t){return t.table.tableId===e.pubTable.key}));if(1===r.length)return r[0];r.length>1&&console.log("Error: 2 active reservations found for same table")}return{reservedBy:"",patronDetails:{patronName:"",patronPhone:""}}}}),methods:{reserveTable:function(){this.$store.dispatch("userModule/fetchUserDetails"),this.$store.dispatch("pubModule/setSelectedPubTable",this.pubTable),this.$router.push({name:"reserve-table",params:{id:this.pubTable.key},query:{pubId:this.pubTable.pubId}})},cancelTableReservation:function(){var e=this;return console.log("cancelling reservation..."),this.$ionic.alertController.create({cssClass:"alert-cancel-res",header:"Cancel Reservation",message:"Are you sure you wish to cancel this reservation?",buttons:[{text:"Back",role:"cancel",handler:function(){console.log("Cancellation abandoned.")}},{text:"Confirm",handler:function(){console.log("Cancellation Confirmed"),e.$store.dispatch("reservationModule/cancelReservationForCurrentlySelectedTable",e.reservation.key)}}]}).then((function(e){return e.present()}))}}},c=u,v=r("2877"),b=Object(v["a"])(c,o,i,!1,null,null,null),p=b.exports,h=r("ff79"),f={name:"pub-details",data:function(){return{i:h,pubImg:null}},components:{TableCard:p},computed:Object(a["a"])(Object(a["a"])(Object(a["a"])({},Object(d["b"])("pubModule",["pubTables","pub"])),Object(d["b"])("userModule",["userId"])),{},{sortedTables:function(){var e=this.pubTables;return e.sort((function(e,t){return e.tableNum-t.tableNum}))}}),created:function(){console.log(this.$route),console.log("current route param id ",this.$route.params.id),this.pub&&this.pub.key===this.$route.params.id?(console.log("current pub key: ",this.pub.key),console.log("current pub in state matches current pub on screen - not retreiving data from db")):(console.log("fecthing pub linked to pub id of: ",this.$route.params.id),this.$store.dispatch("pubModule/fetchPubByPubId",this.$route.params.id))},methods:{editPub:function(){this.$router.push({name:"edit-pub",params:{id:this.pub.key}})}}},m=f,_=(r("d664"),Object(v["a"])(m,n,s,!1,null,"b73ad608",null));t["default"]=_.exports},d664:function(e,t,r){"use strict";var n=r("7d28"),s=r.n(n);s.a},f57b:function(e,t,r){}}]);
//# sourceMappingURL=chunk-78a8eaf7.c790d2eb.js.map